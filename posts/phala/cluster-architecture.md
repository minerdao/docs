# Phala挖矿集群详解
Phala是Polkadot网络上的隐私计算网络，使用支持Intel SGX的CPU进行挖矿，需要质押（以一台8核机器为例，目前最低需要质押3000个，最高大约可质押19000个PHA），具体收益情况请参照(https://app.phala.network/analytics)的相关数据。

该系列文章将详细介绍Phala挖矿集群的网络架构、硬件配置、集群架构和集群部署，及常见运维问题解决。

## 1 挖矿流程
- Kuama/Polkadot Node
- Phala Node
- Phala pherry
- Phala pruntime

## 2 网络架构
这里网络架构以100台左右机器的集群为例，具体请依据自己的机器数量进行调整。
**带宽需求**：Phala集群内网采用**千兆网络**即可满足需求，上联线路最少需要**50M**以上的带宽。
**网络结构**：网络采用常见的二层结构，即核心交换机 -> 接入交换机 -> 机器。

## 3 硬件配置
### 3.1 Node配置
Node机器用来同步Kuasma和Phala节点，运行集群管理系统(PRB)，需要配备至少2T的NVMe SSD，建议4T可避免后期升级及数据迁移的麻烦。
|产品名称|型号|数量|备注|
|------|-----------------------|:-----:|---------|
| 主板 |  | 1 ||
| CPU | Intel(R) Xeon(R) Silver 4210 @ 2.20GHz | 1 ||
| 散热器 | 2011散热器 | 1 ||
| 内存 | 三星 2666 DDR4 ECC REG 16GB| 4 ||
| 系统盘 | 三星 PM980 256G SSD  | 1 ||
| 数据盘 | 三星 PM983 U.2 1.92T SSD | 1 ||
| 机箱 | 2U机箱 + 暴力风扇 | 1 ||
| 电源 | 长城 450W (1+1) | 1 ||

### 3.2 Worker配置
Worker是实际参与挖矿的机器，必须使用支持Intel SGX的CPU，我们根据对多款CPU和主板的测试，推荐以下配置：
|产品名称|型号|数量|备注|
|------|-----------------------|:-----:|---------|
| 主板 | Supermicro Super X11SCA-F | 1 ||
| CPU | Intel(R) Core i9-9900K @ 3.6GHz | 1 ||
| 散热器 | 2011散热器 | 1 ||
| 内存 | 三星 2666 DDR4 ECC REG 16GB| 2 ||
| 系统盘 | 三星 PM980 256G SSD  | 1 ||
| 机箱 | 2U机箱 + 暴力风扇 | 1 ||
| 电源 | 长城 450W (1+1) | 1 | 可换成单电成本更低 |

## 集群架构

### 单机架构
单机架构即官方默认支持的Solo模式，适合小批量机器（10台以内）

### 集群架构

